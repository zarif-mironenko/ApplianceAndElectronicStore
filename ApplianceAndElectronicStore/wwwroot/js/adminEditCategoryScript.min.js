$(function(){var t=+$("#prodSpecQty").val(),n=$("#tblProductSpecifications tbody");$("#btnAddSpecification").click(function(){let r=$("#specificationId");if(r.length==0)var u=0,i=$("#specificationName").val();else u=+r.val(),i=$("option:selected",r).text();let f=$('input[name$="ProductSpecification.Name"]',n);if($('input[name$="ProductSpecification.Name"]',n).is(`[value="${i}"]`)){alert(`Характеристка со значением "${i}" уже добавлена!`);return}t=addProdSpecToTable(n,u,i,t)});$("#CategoryId").change(function(){$.getJSON("/Admin/Products/AjaxGetProductSpecifications",{categoryId:+$(this).val()},function(t){for(var i=0;i<t.length;i++)addProdSpecWithValueToTable(n,t[i],i)})});$('#modalAddSpecification input[name="addCatType"]').change(function(){var t=$("#addCatInputControl"),n=document.createElement("label");n.htmlFor="specificationName";n.innerText="Название";switch(this.id){case"addCatFromExists":$.getJSON("/Admin/Categories/AjaxGetSpecList",{id:+$("#Id").val()},function(i){var u=document.createElement("select"),r;u.id="specificationId";u.className="form-control";r=document.createElement("option");r.value=0;r.text="-- Выберите категорию --";u.options.add(r);for(let n of i)r=document.createElement("option"),r.value=n.id,r.text=n.name,u.options.add(r);t.empty().append(n).append("<br />").append(u)});break;case"addNewCat":let i=document.createElement("input");i.id="specificationName";i.type="text";i.className="form-control";t.empty().append(n).append("<br />").append(i)}});$("#tblProductSpecifications tbody").sortable({stop:function(n,t){let u=Math.round((t.position.top-t.originalPosition.top)/t.item.height()),r=$("[id$=NumberInOrder]",t.item),f=+r.val(),e=f+u,i=$("[id$=NumberInOrder]",t.item.parent());u>0?(i=i.filter(function(){return this.value>f&&this.value<=e}),i.each(function(){this.value--})):u<0&&(i=i.filter(function(){return this.value<f&&this.value>=e}),i.each(function(){this.value++}));i.parent().each(function(n){let t=i.eq(n);$(this).empty().append(t.val()).append(t)});r.val(e);r.parent().empty().append(r.val()).append(r)}})});